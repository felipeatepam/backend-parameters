replicaCount: 1

image:
  repository: backend-parameters
  pullPolicy: IfNotPresent
  tag: ""

imagePullSecrets:
  - name: regcred

nameOverride: ""
fullnameOverride: ""

# --- 1. Service Account (AWS IRSA) ---
serviceAccount:
  create: true
  name: "externalsecrets-aws"
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::183631338639:role/krci-cmtr-0oqfemca-assume-role

# --- 2. Secret Store (ESO) ---
secretStore:
  enabled: true
  name: aws-parameterstore
  region: eu-central-1

# --- 3. External Secrets (ESO) ---
externalSecrets:
  backend-parameters:
    data:
      - secretKey: ENV_VAR5
        remoteRef:
          key: krci-cmtr-0oqfemca-backend-parameters
          property: backend-parameters.ENV_VAR5
      - secretKey: application.secret.properties.from.ps
        remoteRef:
          key: krci-cmtr-0oqfemca-backend-parameters
          property: backend-parameters.config
          decodingStrategy: Base64

# --- 4. Standard ConfigMaps & Secrets (Manual) ---
configMaps:
  cm-extra-env:
    data:
      SERVER_PORT: "8080"
  cm-extra-config:
    data:
      ENV_VAR1: "value_from_cm"
      application.properties: "app.mode=prod"

secrets:
  secret-extra-env:
    stringData:
      ENV_VAR2: "val2"
  secret-extra-config:
    stringData:
      ENV_VAR4: "val4"
      application.secret.properties: "secret.key=123"

# --- 5. Application Configuration (Env & Volumes) ---
envFrom:
  - configMapRef:
      name: cm-extra-env
  - secretRef:
      name: secret-extra-env

env:
  - name: BACKEND_PROFILES_ACTIVE
    value: dev
  - name: ENV_VAR1
    valueFrom:
      configMapKeyRef:
        name: cm-extra-config
        key: ENV_VAR1
  - name: ENV_VAR4
    valueFrom:
      secretKeyRef:
        name: secret-extra-config
        key: ENV_VAR4
  # The ESO Env Var
  - name: ENV_VAR5
    valueFrom:
      secretKeyRef:
        name: backend-parameters
        key: ENV_VAR5

volumes:
  - name: configmap-volume
    configMap:
      name: cm-extra-config
      items:
        - key: application.properties
          path: application.properties
  - name: secret-volume
    secret:
      secretName: secret-extra-config
      items:
        - key: application.secret.properties
          path: application.secret.properties
  # The ESO Volume
  - name: ps-volume
    secret:
      secretName: backend-parameters
      items:
        - key: application.secret.properties.from.ps
          path: application.secret.properties.from.ps

volumeMounts:
  - name: configmap-volume
    readOnly: true
    mountPath: /config
  - name: secret-volume
    readOnly: true
    mountPath: /secret-config
  # The ESO Mount
  - name: ps-volume
    readOnly: true
    mountPath: /ps-config

# --- 6. Networking ---
service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: true
  className: ""
  annotations: {}
  hosts:
    - host: edpDefault
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []

resources: {}
autoscaling:
  enabled: false
livenessProbe:
  tcpSocket:
    port: http
readinessProbe:
  tcpSocket:
    port: http
  initialDelaySeconds: 20
podAnnotations: {}
podLabels: {}
podSecurityContext: {}
securityContext: {}
nodeSelector: {}
tolerations: []
affinity: {}
